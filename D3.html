<!DOCTYPE html>
<!-- saved from url=(0034)https://qmdeethree.github.io/#work -->
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
    .gm-err-container {
      height: 100%;
      width: 100%;
      display: table;
      background-color: #e0e0e0;
      position: relative;
      left: 0;
      top: 0
    }

    .gm-err-content {
      border-radius: 1px;
      padding-top: 0;
      padding-left: 10%;
      padding-right: 10%;
      position: static;
      vertical-align: middle;
      display: table-cell
    }

    .gm-err-content a {
      color: #4285f4
    }

    .gm-err-icon {
      text-align: center
    }

    .gm-err-title {
      margin: 5px;
      margin-bottom: 20px;
      color: #616161;
      font-family: Roboto, Arial, sans-serif;
      text-align: center;
      font-size: 24px
    }

    .gm-err-message {
      margin: 5px;
      color: #757575;
      font-family: Roboto, Arial, sans-serif;
      text-align: center;
      font-size: 12px
    }

    .gm-err-autocomplete {
      padding-left: 20px;
      background-repeat: no-repeat;
      background-size: 15px 15px
    }
  </style>
  <style type="text/css">
    .gm-style .gm-style-mtc label,
    .gm-style .gm-style-mtc div {
      font-weight: 400
    }
  </style>
  <link type="text/css" rel="stylesheet" href="./D3_files/css">
  <style type="text/css">
    .gm-style .gm-style-cc span,
    .gm-style .gm-style-cc a,
    .gm-style .gm-style-mtc div {
      font-size: 10px
    }
  </style>
  <style type="text/css">
    @media print {
      .gm-style .gmnoprint,
      .gmnoprint {
        display: none
      }
    }

    @media screen {
      .gm-style .gmnoscreen,
      .gmnoscreen {
        display: none
      }
    }
  </style>
  <style type="text/css">
    .gm-style-pbc {
      transition: opacity ease-in-out;
      background-color: rgba(0, 0, 0, 0.45);
      text-align: center
    }

    .gm-style-pbt {
      font-size: 22px;
      color: white;
      font-family: Roboto, Arial, sans-serif;
      position: relative;
      margin: 0;
      top: 50%;
      -webkit-transform: translateY(-50%);
      -ms-transform: translateY(-50%);
      transform: translateY(-50%)
    }
  </style>
  <title>D3</title>


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./D3_files/w3.css">
  <link rel="stylesheet" href="./D3_files/css(1)">
  <link rel="stylesheet" href="./D3_files/font-awesome.min.css">


  <link type="text/css" rel="stylesheet" href="./Dorling Cartogram_files/ex.css">
  <!-- unnecessary -->
  <link type="text/css" rel="stylesheet" href="./Dorling Cartogram_files/jquery-ui-1.8rc3.custom.css">
  <link type="text/css" rel="stylesheet" href="./Dorling Cartogram_files/D3Styles.css">

  <script type="text/javascript" src="./Dorling Cartogram_files/protovis-r3.2.js"></script>
  <script type="text/javascript" src="./Dorling Cartogram_files/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./Dorling Cartogram_files/jquery-ui-1.8rc3.custom.min.js"></script>
  <script type="text/javascript" src="./Dorling Cartogram_files/centroid.js"></script>


  <script type="text/javascript" src="./Dorling Cartogram_files/borough_lowres2.js"></script>
  <script type="text/javascript" src="./Dorling Cartogram_files/borough_stats2.js"></script>
  <script type="text/javascript" src="./Dorling Cartogram_files/borough_borders2.js"></script>

  <style>
    body,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {

      font-family: "Raleway";
      font-weight: "bold";
    }

    body,
    html {
      height: 100%;
      line-height: 1.8;

    }

    /* Full height image header */

    .bgimg-1 {
      background-position: center;
      background-size: cover;
      background-image: url("https://realbusiness.co.uk/wp-content/uploads/2017/02/shutterstock_362072633.jpg");
      min-height: 100%;
    }

    .w3-bar .w3-button {
      padding: 16px;
    }


    #canvas123 {
      background-color: #000;
      width: 100%;
      height: 100%;
      /*height: 200px;*/
      /*border: 5px solid red;*/
      /*margin: 100px;*/
      /*padding: 0px;*/
      position: static;
      /* fixed or static */
      /*top: 100px;
   left: 100px;*/
      overflow: hidden;
    }
  </style>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/common.js"></script>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/map.js"></script>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/util.js"></script>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/marker.js"></script>
  <style type="text/css">
    .gm-style {
      font: 400 11px Roboto, Arial, sans-serif;
      text-decoration: none;
    }

    .gm-style img {
      max-width: none;
    }
  </style>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/onion.js"></script>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/controls.js"></script>
  <script type="text/javascript" charset="UTF-8" src="./D3_files/stats.js"></script>
</head>

<body>

  <!-- Navbar (sit on top) -->
  <div class="w3-top">
    <div class="w3-bar w3-white w3-card" id="myNavbar">
      <a href="https://qmdeethree.github.io/#home" class="w3-bar-item w3-button w3-wide">LOGO</a>
      <!-- Right-sided navbar links -->
      <div class="w3-right w3-hide-small">
        <a href="https://qmdeethree.github.io/#about" class="w3-bar-item w3-button">INTRO</a>
        <a href="https://qmdeethree.github.io/#team" class="w3-bar-item w3-button"><i class="fa fa-user"></i> TEAM</a>
        <a href="https://qmdeethree.github.io/#work" class="w3-bar-item w3-button"><i class="fa fa-database"></i> DATA</a>
        <a href="https://qmdeethree.github.io/#pricing" class="w3-bar-item w3-button"><i class="fa fa-th"></i> METHODS</a>
        <a href="https://qmdeethree.github.io/#visualisation" class="w3-bar-item w3-button"><i class="fa fa-eye"></i> VISUALISATION</a>
        <a href="https://qmdeethree.github.io/#conclu" class="w3-bar-item w3-button"><i class="fa fa-check"></i> CONCLUSION</a>
      </div>
      <!-- Hide right-floated links on small screens and replace them with a menu icon -->

      <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="w3_open()">
      <i class="fa fa-bars"></i>
    </a>
    </div>
  </div>

  <!-- Sidebar on small screens when clicking the menu icon -->
  <nav class="w3-sidebar w3-bar-block w3-black w3-card w3-animate-left w3-hide-medium w3-hide-large" style="display:none" id="mySidebar">
    <a href="javascript:void(0)" onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-padding-16">Close ×</a>
    <a href="https://qmdeethree.github.io/#about" onclick="w3_close()" class="w3-bar-item w3-button">ABOUT</a>
    <a href="https://qmdeethree.github.io/#team" onclick="w3_close()" class="w3-bar-item w3-button">TEAM</a>
    <a href="https://qmdeethree.github.io/#work" onclick="w3_close()" class="w3-bar-item w3-button">WORK</a>
    <a href="https://qmdeethree.github.io/#pricing" onclick="w3_close()" class="w3-bar-item w3-button">PRICING</a>
    <a href="https://qmdeethree.github.io/#contact" onclick="w3_close()" class="w3-bar-item w3-button">CONTACT</a>
  </nav>

  <!-- Header with full-height image -->
  <header class="bgimg-1 w3-display-container w3-grayscale-min" id="home">
    <div class="w3-display-left w3-text-black" style="padding:2%; padding-bottom:19%; line-height:1em;">
      <span class="w3-jumbo w3-hide-small">Disease, Dollar, Data</span><br>
      <span class="w3-xxlarge w3-hide-large w3-hide-medium" color="black">Disease, Dollar, Data</span><br>
      <span class="w3-large">An analysis by Daisy, India, José, Thomas and Justas</span>
      <p><a href="https://qmdeethree.github.io/#about" style=" border: 5px red solid;" class="w3-button w3-white w3-padding-large w3-large w3-margin-top w3-opacity w3-hover-opacity-off">Explore our story</a></p>
    </div>
    <!-- <div class="w3-display-bottomleft w3-text-grey w3-large" style="padding:24px 48px">
    <i class="fa fa-facebook-official w3-hover-opacity"></i>
    <i class="fa fa-instagram w3-hover-opacity"></i>
    <i class="fa fa-snapchat w3-hover-opacity"></i>
    <i class="fa fa-pinterest-p w3-hover-opacity"></i>
    <i class="fa fa-twitter w3-hover-opacity"></i>
    <i class="fa fa-linkedin w3-hover-opacity"></i>
  </div> -->
  </header>

  <!-- About Section -->
  <div class="w3-container" style="padding:128px 16px" id="about">
    <h3 class="w3-center">Vision and Motivation</h3>
    <p class="w3-center w3-large">Exploring what living with poverty entails in a big city </p>
    <div class="w3-row-padding w3-center" style="margin-top:64px">
      <div class="w3-quarter">
        <i class="fa fa-book w3-margin-bottom w3-jumbo w3-center"></i>
        <p class="w3-large">Literature</p>
        <p>It is a consensus in literature that living with impoverished conditions - in other words, people that have low incomes - entails living with other negative socioeconomic factors such as increased mortality, low school attendance, low health in
          relation to higher income people (Evans &amp; English, 2002; Tilak, 2002).
        </p>
      </div>
      <div class="w3-quarter">
        <i class="fa fa-calendar w3-margin-bottom w3-jumbo"></i>
        <p class="w3-large">However...</p>
        <p>However, the factors that are correlated with poverty are not consistent over time and space. They differ due to the political systems, the welfare state and the general state of the economy in a given period in a given place.
        </p>
      </div>
      <div class="w3-quarter">
        <i class="fa fa-building w3-margin-bottom w3-jumbo"></i>
        <p class="w3-large">City Focus</p>
        <p>There are very few studies that have focused on exploring what living with poverty entails in specific cities. However, only by knowing this can we aim to apply policies that truly improve the lives of individuals and families living with low
          incomes.
        </p>
      </div>
      <div class="w3-quarter">
        <i class="fa fa-eye w3-margin-bottom w3-jumbo"></i>
        <p class="w3-large">Conclusion</p>
        <p>Our motivation is therefore to understand what living with poverty in London entails. Our vision is to be able to provide the general public as well as policy makers with information that can benefit the way we approach poverty in London.
        </p>
      </div>
    </div>
  </div>

  <!-- Promo Section - "We know design" -->
  <div class="w3-container w3-light-grey" style="padding:128px 16px">
    <div class="w3-row-padding">
      <div class="w3-col m6">
        <h3>Aims, Hypotheses and Assumptions</h3>
        <p>Our aim is to explore what correlates with poverty - as measured by income - in London. We will look at various variables that represent a spectrum of factors that have been shown to be correlated with poverty in different settings, such as health,
          physical activity, and availability of green spaces. This data is organised and measured by borough (Barking and Dagenham, Barnet, Bexley, Brent, Bromley, Camden, City of London*, Croydon, Ealing, Enfield, Greenwich, Hackney, Hammersmith and
          Fulham, Haringey, Harrow, Havering, Hillingdon, Hounslow, Islington, Kensington and Chelsea, Kingston upon Thames, Lambeth, Lewisham, Merton, Newham, Redbridge, Richmond upon Thames, Southwark, Sutton, Tower Hamlets, Waltham Forest, Wandsworth,
          Westminster.)
          <br>*The City of London is the 33rd principal division of Greater London but it is not a borough. For our purposes, however, we will be treating it as such.<br>
        </p>

      </div>
      <div class="w3-col m6">
        <img class="w3-image w3-round-large" src="./D3_files/buildings.jpg" alt="Buildings" width="700" height="394">
      </div>
    </div>
  </div>

  <!-- Team Section -->
  <div class="w3-container" id="team">
    <h3 class="w3-center">THE TEAM</h3>
    <p class="w3-center w3-large">The team behind the vision</p>
    <div class="w3-row-padding" style="margin-left:190px">
      <div class="w3-col l2 m2 w3-margin-bottom">
        <div class="w3-card">
          <img src="./D3_files/daisy.jpg" alt="John" style="width:100%">
          <div class="w3-container">
            <h3>Daisy </h3>
            <p class="w3-opacity">Statistical Techniques</p>
            <p>Once beat the Harry Potter society at their own quiz</p>
          </div>
        </div>
      </div>
      <div class="w3-col l2 m2 w3-margin-bottom">
        <div class="w3-card">
          <img src="./D3_files/harrodsindia.jpg" alt="Jane" style="width:100%">
          <div class="w3-container">
            <h3>India </h3>
            <p class="w3-opacity">Team Leader</p>
            <p>Can recite the Captain America films word-for-word </p>
          </div>
        </div>
      </div>
      <div class="w3-col l2 m2 w3-margin-bottom">
        <div class="w3-card">
          <img src="./D3_files/jose.jpg" alt="Mike" style="width:100%">
          <div class="w3-container">
            <h3>José </h3>
            <p class="w3-opacity">Researcher</p>
            <p>Admitted Twilight was better than Harry Potter</p>
          </div>
        </div>
      </div>
      <div class="w3-col l2 m2 w3-margin-bottom">
        <div class="w3-card">
          <img src="./D3_files/thomas.jpg" alt="Mike" style="width:100%">
          <div class="w3-container">
            <h3>Thomas </h3>
            <p class="w3-opacity">Web Designer</p>
            <p>A beautiful, and our favourite, Eurasian bird of Paradise</p>
          </div>
        </div>
      </div>
      <div class="w3-col l2 m2 w3-margin-bottom">
        <div class="w3-card">
          <img src="./D3_files/justas.jpg" alt="Dan" style="width:100%">
          <div class="w3-container">
            <h3>Justas </h3>
            <p class="w3-opacity">Visualisation jedi</p>
            <p>If found please return to the Bartlett (22 Gordon St, London)</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Promo Section "Statistics" -->
  <div class="w3-container w3-row w3-center w3-dark-grey w3-padding-64">
    <div class="w3-quarter">
      <span class="w3-xxlarge">14+</span>
      <br>Partners
    </div>
    <div class="w3-quarter">
      <span class="w3-xxlarge">55+</span>
      <br>Projects Done
    </div>
    <div class="w3-quarter">
      <span class="w3-xxlarge">89+</span>
      <br>Happy Clients
    </div>
    <div class="w3-quarter">
      <span class="w3-xxlarge">150+</span>
      <br>Meetings
    </div>
  </div>

  <!-- Work Section -->
  <div class="w3-container" style="padding:128px 16px" id="work">
    <h3 class="w3-center">OUR WORK</h3>
    <p class="w3-center w3-large">What we've done for people</p>

    <div class="w3-row-padding" style="margin-top:64px">
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_mic.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A microphone">
      </div>
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_phone.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A phone">
      </div>
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_drone.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A drone">
      </div>
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_sound.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Soundbox">
      </div>
    </div>

    <div class="w3-row-padding w3-section">
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_tablet.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A tablet">
      </div>
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_camera.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A camera">
      </div>
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_typewriter.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A typewriter">
      </div>
      <div class="w3-col l3 m6">
        <img src="./D3_files/tech_tableturner.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="A tableturner">
      </div>
    </div>
  </div>

  <!-- Modal for full size images on click-->
  <div id="modal01" class="w3-modal w3-black" onclick="this.style.display=&#39;none&#39;">
    <span class="w3-button w3-xxlarge w3-black w3-padding-large w3-display-topright" title="Close Modal Image">×</span>
    <div class="w3-modal-content w3-animate-zoom w3-center w3-transparent w3-padding-64">
      <img id="img01" class="w3-image">
      <p id="caption" class="w3-opacity w3-large"></p>
    </div>
  </div>

  <!-- Skills Section -->
  <div class="w3-container w3-light-grey w3-padding-64">
    <div class="w3-row-padding">
      <div class="w3-col m6">
        <h3>Our Skills.</h3>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod<br> tempor incididunt ut labore et dolore.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod<br> tempor incididunt ut labore et dolore.</p>
      </div>
      <div class="w3-col m6">
        <p class="w3-wide"><i class="fa fa-camera w3-margin-right"></i>Photography</p>
        <div class="w3-grey">
          <div class="w3-container w3-dark-grey w3-center" style="width:90%">90%</div>
        </div>
        <p class="w3-wide"><i class="fa fa-desktop w3-margin-right"></i>Web Design</p>
        <div class="w3-grey">
          <div class="w3-container w3-dark-grey w3-center" style="width:85%">85%</div>
        </div>
        <p class="w3-wide"><i class="fa fa-photo w3-margin-right"></i>Photoshop</p>
        <div class="w3-grey">
          <div class="w3-container w3-dark-grey w3-center" style="width:75%">75%</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pricing Section -->
  <div class="w3-container w3-center w3-dark-grey" style="padding:128px 16px" id="pricing">
    <h3>PRICING</h3>
    <p class="w3-large">Choose a pricing plan that fits your needs.</p>
    <div class="w3-row-padding" style="margin-top:64px">
      <div class="w3-third w3-section">
        <ul class="w3-ul w3-white w3-hover-shadow">
          <li class="w3-black w3-xlarge w3-padding-32">Basic</li>
          <li class="w3-padding-16"><b>10GB</b> Storage</li>
          <li class="w3-padding-16"><b>10</b> Emails</li>
          <li class="w3-padding-16"><b>10</b> Domains</li>
          <li class="w3-padding-16"><b>Endless</b> Support</li>
          <li class="w3-padding-16">
            <h2 class="w3-wide">$ 10</h2>
            <span class="w3-opacity">per month</span>
          </li>
          <li class="w3-light-grey w3-padding-24">
            <button class="w3-button w3-black w3-padding-large">Sign Up</button>
          </li>
        </ul>
      </div>
      <div class="w3-third">
        <ul class="w3-ul w3-white w3-hover-shadow">
          <li class="w3-red w3-xlarge w3-padding-48">Pro</li>
          <li class="w3-padding-16"><b>25GB</b> Storage</li>
          <li class="w3-padding-16"><b>25</b> Emails</li>
          <li class="w3-padding-16"><b>25</b> Domains</li>
          <li class="w3-padding-16"><b>Endless</b> Support</li>
          <li class="w3-padding-16">
            <h2 class="w3-wide">$ 25</h2>
            <span class="w3-opacity">per month</span>
          </li>
          <li class="w3-light-grey w3-padding-24">
            <button class="w3-button w3-black w3-padding-large">Sign Up</button>
          </li>
        </ul>
      </div>
      <div class="w3-third w3-section">
        <ul class="w3-ul w3-white w3-hover-shadow">
          <li class="w3-black w3-xlarge w3-padding-32">Premium</li>
          <li class="w3-padding-16"><b>50GB</b> Storage</li>
          <li class="w3-padding-16"><b>50</b> Emails</li>
          <li class="w3-padding-16"><b>50</b> Domains</li>
          <li class="w3-padding-16"><b>Endless</b> Support</li>
          <li class="w3-padding-16">
            <h2 class="w3-wide">$ 50</h2>
            <span class="w3-opacity">per month</span>
          </li>
          <li class="w3-light-grey w3-padding-24">
            <button class="w3-button w3-black w3-padding-large">Sign Up</button>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- VISUALISATION Section -->
  <div class="w3-container w3-light-grey" style="padding:128px 16px" id="visualisation">
    <h3 class="w3-center">VISUALISATIONS</h3>
    <p class="w3-center w3-large">5 D3 Visualisations and 1 three.js</p>
    <!-- <div class="w3-row-padding" style="margin-top:64px"> -->

    <div id="centerDefault">

      <div id="figDefault">
        <div id="containerDefault">

          <b style="" id="yearLabelDefault"> Categories: </b>
          <!-- class name unnecessary -->
          <!-- <div style=" " id="yearSliderGreen" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"><a href="http://mbostock.github.io/protovis/ex/cartogram-full.html#" class="ui-slider-handle ui-state-default ui-corner-all" style="left: 100%;"></a></div> -->
          <div style="" id="yearSliderDefault">
            <!-- border: 5px green solid; -->
            <!-- <a href="http://mbostock.github.io/protovis/ex/cartogram-full.html#" class="ui-slider-handle ui-state-default ui-corner-all" style="left: 100%;"></a> -->
          </div>
          <!-- <img id="playDefault" src="./Dorling Cartogram_files/play.png" alt="Play" onclick="playClick()"> -->
        </div>

        <script type="text/javascript+protovis">
          $(yearSliderDefault).slider({
            min: borough_stats2.minYear,
            max: borough_stats2.maxYear,
            value: borough_stats2.maxYear,
            slide: function(e, ui) {
              year = ui.value;
              updateYear();
              vis.render();

            }
          });

          var year = 2008;

          borough_lowres2.forEach(function(c) {
            c.center = centroid(c.borders[0]);
            //console.log(c.code, c.center);
          });

          var i = 0,
            w = 900,
            h = 500,
            mapMargin = 30,
            mapMargin_ = 200;

          var longitude = -64; //-64
          var latitude = -24; //-24
          var scale = pv.Geo.scale()
            // .domain({lng: -32, lat: -32 }, {lng: 335, lat:335 }) //old centroid
            .domain({
              lng: 10,
              lat: 0
            }, {
              lng: 250,
              lat: -200
            }) //richmon missing, got to increase
            //FIXING CITY AND RICHMOND
            .range({
              x: mapMargin_,
              y: -20
            }, {
              x: w - mapMargin_,
              y: h - 0
            });

          var legendMargin = 20,
            ease = null,
            //change text width bellow the sliding bar
            yearsMargin = 40, //same values as in D3Styles.css
            yearsMargin_ = 180;

          var yearsScale = pv.Scale.linear()
            .domain(borough_stats2.minYear, borough_stats2.maxYear)
            .range(yearsMargin_ + 2, w - yearsMargin);

          var legendScale = pv.Scale.linear()
            .domain(14, 35)
            .range(legendMargin, w - legendMargin);

            // city 63620 and newham 28780

          var col = function(v) {
            if (v < 28781) return "#008038";
            if (v < 35749) return "#A3D396";
            if (v < 42717) return "#FDD2AA";
            if (v < 49685) return "#F7976B";
            if (v < 56659) return "#F26123";
            if (v < 63621) return "#E12816";
            /* else */
            return "#B7161E";
          };

          var numToRad = function(n) {
            return Math.sqrt(n) / 35; //change rad
          };

          var nodes = [],
            codeToNode = [],
            links = [];

          //   console.log(borough_stats2['City']);

          borough_lowres2.forEach(function(s) {
           if (borough_stats2[s.code]) { //s.code
              //borough_stats2[s.code]
              var x = scale(s.center).x,
                y = scale(s.center).y,
              //  numObese = borough_stats2[s.code].pop[borough_stats2.yearIdx(year)] * borough_stats2[s.code].obese[borough_stats2.yearIdx(year)] / 100,
              numObese= borough_stats2[s.code].all[borough_stats2.yearIdx(year)],

                n = {
                  x: x,
                  y: y,
                  p: {
                    x: x,
                    y: y
                  },
                  r: numToRad(numObese),
                  code: s.code
                };
                console.log(numObese);
              nodes.push(n);
              codeToNode[s.code] = n;
              // console.log(s.code,n);
            }
            // console.log(s.code,x,y)
          });

          borough_lowres2.forEach(function(s) {
            if (borough_stats2[s.code]) {
              var borders = borough_borders2[s.code];
              borders.forEach(function(b) {
                if (codeToNode[s.code] && codeToNode[b] && s.code < b) {
                  var nodeA = codeToNode[s.code];
                  var nodeB = codeToNode[b];
                  links.push({
                    sourceNode: nodeA,
                    targetNode: nodeB,
                    length: (nodeA.r + nodeB.r + 2)
                  });
                }
              });
            }
          });

          function updateYear() {
            nodes.forEach(function(n) n.r = numToRad(borough_stats2[n.code].all[borough_stats2.yearIdx(year)]*22000 ));
            links.forEach(function(l) l.length = (l.sourceNode.r + l.targetNode.r + 2));
            i = 0;
            var stepSome = setInterval(function() {
              if (i++ > 10) clearInterval(stepSome);
              sim.step();
              vis.render();
            }, 20);
          }

          updateYear();
          var timer = undefined;

          // function playClick() {
          //   if (timer) {
          //     stop();
          //   } else {
          //     if (year == borough_stats2.maxYear) year = borough_stats2.minYear;
          //     $(yearSliderDefault).slider('value', year);
          //     $(play).attr("src", 'stop.png');
          //     updateYear();
          //     vis.render();
          //     timer = setInterval(function() {
          //       year++;
          //       if (year >= borough_stats2.maxYear) stop();
          //       $(yearSliderDefault).slider('value', year);
          //       updateYear();
          //       vis.render();
          //     }, 400);
          //   }
          // }
          //
          // // Stop the animation
          // function stop() {
          //   clearInterval(timer);
          //   timer = undefined;
          //   $(play).attr("src", 'play.png');
          // }
          var cats = ["Income", "Life Expectancy", "Green Spaces", "Active Kids",	"Drugs"];
          //check this collission constraint for possible solution
          var collisionConstraint = pv.Constraint.collision(function(d) d.r + 1),
            positionConstraint = pv.Constraint.position(function(d) d.p),
            linkConstraint = pv.Force.spring(100).links(links);

          var sim = pv.simulation(nodes)
            .constraint(collisionConstraint)
            .constraint(positionConstraint)
            .constraint(linkConstraint)
            .force(pv.Force.drag());

          var vis = new pv.Panel()
            .width(w)
            .height(h)
            .top(50)
            .bottom(30);

          // Add the ticks and labels for the year slider
          vis.add(pv.Rule)
            .data(pv.range(borough_stats2.minYear, borough_stats2.maxYear + .1))
            .left(yearsScale)
            .height(4)
            .top(-50)
            .anchor("bottom").add(pv.Label)
              .text(function(d) cats[cats.length-this.index-1]);

          vis.add(pv.Dot)
            .data(nodes)
            .left(function(d) d.x)
            .top(function(d) d.y)
            .radius(function(d) d.r)
            .fillStyle(function(d) col(borough_stats2[d.code].income))
            .strokeStyle(null)
            .title(function(d) borough_stats2[d.code].name + "\nIncome: £" +borough_stats2[d.code].income+
            "\nLife Expectancy: "+borough_stats2[d.code].life+
            "\nGreen Spaces: "+borough_stats2[d.code].green+
            "\nActive Kids: "+borough_stats2[d.code].kids+
            "\nDrug Contact: "+borough_stats2[d.code].drugs)// + borough_stats2[d.code].obese[borough_stats2.yearIdx(year)] + "%"
            .add(pv.Label)
            .text(function(d) d.code)
          //  .textStyle("#fee")
            .font(function(d)
             + (2.9 * Math.log(d.r)).toFixed(0) + "px sans-serif")
            .textAlign("center")
            .textBaseline("middle");




           vis.add(pv.Bar)//range MIN MAX STEP as denominator
            .data(pv.range(28000, 63000, 6160))
            .bottom(function(d) this.index * 15 - 28)
            .height(12)
            .width(12)
            .left(5)
            .fillStyle(function(d) col(28000+this.index*6000))
            .lineWidth(null)
            .anchor("right").add(pv.Label)
            .textAlign("left")
            .text(function(d) "> £"+d);


            // var trick=0;
            // var treat=0;
            // function scaleViz(){
            //   trick=1;
            //
            //   vis.add(pv.Dot)
            //       .data([
            //           {v: 10000000, l: "10M"},
            //           {v: 1000000, l: "1M"},
            //           {v: 5000000, l: "5M"},
            //           {v: 100000, l: "100K"}
            //         ])
            //       .fillStyle(null)
            //       .strokeStyle("#000000")
            //       .left(150)
            //       .bottom(-30)
            //       .radius(function(d) numToRad(d.v))
            //     .anchor("top").add(pv.Label)
            //       .text(function(d) d.l)
            // }
            //
            // function deScaleViz(){
            //
            // treat=1;
            //   vis.add(pv.Dot)
            //       .data([
            //           {v: 10000000, l: "10M"},
            //           {v: 1000000, l: "1M"},
            //           {v: 5000000, l: "5M"},
            //           {v: 100000, l: "100K"}
            //         ])
            //       .fillStyle(null)
            //       .strokeStyle("#e0e0e0")
            //       .left(150)
            //       .bottom(-30)
            //       .radius(function(d) numToRad(d.v))
            //     .anchor("top").add(pv.Label)
            //       .text(function(d) d.l)
            // }



          ease = setInterval(function() {
            if (i++ > 840) {
              clearInterval(ease);
              ease = null;
            }

              // if(year==2006){
              //   trick++;
              //   if(trick<2){
              //     scaleViz();
              //     treat=0;}
              //   }
              // else{
              //   treat++;
              //   if(treat<2){
              //       deScaleViz();
              //       trick=0;}
              // }
              //


            sim.step();
            positionConstraint.alpha(Math.pow(.7, i + 2) + .08);
            linkConstraint.damping(Math.pow(.7, i + 2) + .3);
            vis.render();
          }, 40);




        </script>
      </div>
    </div>

    <div style="border: 0px solid blue; margin-left: 60%; margin-right: 5%">
      <h1>Reimagining visualising income</h1>
      <h3>A Dorling Cartogram</h3>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
        in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      </p>
      <h3>Comparing Income Against Other Data</h3>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
        in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      </p>
    </div>


    // <h1 style="clear: left;">test test test</h1>


    <div id="canvas123">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/88/three.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.5/dat.gui.js"></script>
      <script src="threeVisualisation.js"></script>
    </div>

    // <h1>HERE WE HAD Google Maps</h1>

    <!-- <div class="w3-half">
      <p><i class="fa fa-map-marker fa-fw w3-xxlarge w3-margin-right"></i> Chicago, US</p>
      <p><i class="fa fa-phone fa-fw w3-xxlarge w3-margin-right"></i> Phone: +00 151515</p>
      <p><i class="fa fa-envelope fa-fw w3-xxlarge w3-margin-right"> </i> Email: mail@mail.com</p>
      <br>
      <form action="https://qmdeethree.github.io/action_page.php" target="_blank">
        <p><input class="w3-input w3-border" type="text" placeholder="Name" required="" name="Name"></p>
        <p><input class="w3-input w3-border" type="text" placeholder="Email" required="" name="Email"></p>
        <p><input class="w3-input w3-border" type="text" placeholder="Subject" required="" name="Subject"></p>
        <p><input class="w3-input w3-border" type="text" placeholder="Message" required="" name="Message"></p>
        <p>
          <button class="w3-button w3-black" type="submit">
            <i class="fa fa-paper-plane"></i> SEND MESSAGE
          </button>
        </p>
      </form>
    </div> -->
    <!-- <div class="w3-half">
      Add Google Maps
      <div id="googleMap" class="w3-greyscale-max" style="width: 100%; height: 510px; position: relative; overflow: hidden;"><div style="height: 100%; width: 100%; position: absolute; top: 0px; left: 0px; background-color: rgb(229, 227, 223);"><div class="gm-err-container"><div class="gm-err-content"><div class="gm-err-icon"><img src="./D3_files/icon_error.png" draggable="false" style="user-select: none;"></div><div class="gm-err-title">Sorry! Something went wrong.</div><div class="gm-err-message">This page didn't load Google Maps correctly. See the JavaScript console for technical details.</div></div></div></div></div>
    </div> -->
    <!-- </div> -->
  </div>


  <!-- Footer -->
  <footer class="w3-center w3-black w3-padding-64">
    <a href="https://qmdeethree.github.io/#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>To the top</a>
    <div class="w3-xlarge w3-section">
      <i class="fa fa-facebook-official w3-hover-opacity"></i>
      <i class="fa fa-instagram w3-hover-opacity"></i>
      <i class="fa fa-snapchat w3-hover-opacity"></i>
      <i class="fa fa-pinterest-p w3-hover-opacity"></i>
      <i class="fa fa-twitter w3-hover-opacity"></i>
      <i class="fa fa-linkedin w3-hover-opacity"></i>
    </div>
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
  </footer>

  <!-- Add Google Maps -->
  <script>
    // function myMap()
    // {
    //   myCenter=new google.maps.LatLng(41.878114, -87.629798);
    //   var mapOptions= {
    //     center:myCenter,
    //     zoom:12, scrollwheel: false, draggable: false,
    //     mapTypeId:google.maps.MapTypeId.ROADMAP
    //   };
    //   var map=new google.maps.Map(document.getElementById("googleMap"),mapOptions);
    //
    //   var marker = new google.maps.Marker({
    //     position: myCenter,
    //   });
    //   marker.setMap(map);
    // }

    // Modal Image Gallery
    function onClick(element) {
      document.getElementById("img01").src = element.src;
      document.getElementById("modal01").style.display = "block";
      var captionText = document.getElementById("caption");
      captionText.innerHTML = element.alt;
    }


    // Toggle between showing and hiding the sidebar when clicking the menu icon
    var mySidebar = document.getElementById("mySidebar");

    function w3_open() {
      if (mySidebar.style.display === 'block') {
        mySidebar.style.display = 'none';
      } else {
        mySidebar.style.display = 'block';
      }
    }

    // Close the sidebar with the close button
    function w3_close() {
      mySidebar.style.display = "none";
    }
  </script>
  <script src="./D3_files/js"></script>
  <!--
To use this code on your website, get a free API key from Google.
Read more at: https://www.w3schools.com/graphics/google_maps_basic.asp
-->



</body>

</html>
